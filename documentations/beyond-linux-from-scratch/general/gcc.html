<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      GCC-8.2.0
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-8.4">
    <div class="navheader">
      <h4>
        Au-delà&nbsp;de Linux<sup>®</sup> From Scratch - Version 8.4
      </h4>
      <h3>
        Chapitre&nbsp;13.&nbsp;Programmation
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="expect.html" title=
          "Expect-5.45.4">Précédent</a>
          <p>
            Expect-5.45.4
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="gcc-ada.html" title=
          "GCC-Ada-8.2.0">Suivant</a>
          <p>
            GCC-Ada-8.2.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="prog.html" title=
          "Chapitre&nbsp;13.&nbsp;Programmation">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà&nbsp;de Linux® From Scratch - Version 8.4">Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="gcc" name="gcc"></a>GCC-8.2.0
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à GCC
        </h2>
        <p>
          Le paquet <span class="application">GCC</span> contient la
          collection de compilateurs GNU. Cette page décrit l'installation
          des compilateurs pour les langages suivants&nbsp;: C, C++, Fortran,
          Objective C, Objective C++ et Go. Un langage supplémentaire, Ada
          est disponible dans cette collection. Il a cependant besoin d'une
          version binaire de lui-même pour la première installation, donc il
          est décrit dans une pages séparée (<a class="xref" href=
          "gcc-ada.html" title="GCC-Ada-8.2.0">GCC-Ada-8.2.0</a>), mais vous
          pouvez l'ajouter ici si vous effectuez une reconstruction ou une
          mise à jour. Comme C et C++ sont installés dans LFS, cette page est
          utile soit pour mettre à jour C et C++, soit pour installer des
          compilateurs supplémentaires.
        </p>
        <p>
          Ce paquet est connu pour se construire correctement sur une
          plateforme LFS-8.4.
        </p>
        <div class="admon caution">
          <img alt="[Attention]" src="../images/caution.png" />
          <h3>
            Attention
          </h3>
          <p>
            Si vous mettez à jour depuis une version de <span class=
            "application">GCC</span> antérieure à 8.2.0, vous devez faire
            attention en compilant les modules externes au noyau. Vous
            devriez vous assurer que le noyau et tous ses modules natifs sont
            aussi compilés en utilisant la même version de <span class=
            "application">GCC</span> que celle utilisée pour construire les
            modules externes. Ce problème ne touche pas les mises à jour du
            noyau natif (et des modules du noyau), car les instructions
            ci-dessous sont une réinstallation complète de <span class=
            "application">GCC</span>. Si vous avez installé des modules
            externes, assurez-vous qu'ils soient recompilés en utilisant la
            version mise à jour de <span class="application">GCC</span>.
            Comme toujours, ne mettez jamais à jour les en-têtes du noyau à
            partir de celles utilisées quand on a compilé <span class=
            "application">Glibc</span> dans LFS.
          </p>
          <p>
            Certains en-têtes système doivent être corrigés pour être
            utilisés avec GCC. Cela se fait pendant l'installation de GCC et
            les en-têtes <span class="quote">«&nbsp;<span class=
            "quote">corrigés</span>&nbsp;»</span> sont installés dans
            <code class="filename">/usr/lib/gcc/&lt;triplet
            machine&gt;/&lt;version GCC&gt;/include-fixed</code> . Cela est
            sans danger si GCC est construit pendant la phase LFS. Mais si
            vous réinstallez GCC dans BLFS, certains des paquets de BLFS
            peuvent être <span class="quote">«&nbsp;<span class=
            "quote">corrigés</span>&nbsp;»</span>. Si un de ces paquets est
            réinstallé ensuite, les en-têtes <span class=
            "quote">«&nbsp;<span class="quote">corrigés</span>&nbsp;»</span>
            ne sont pas mis à jour, ce qui peut occasionner des incohérences
            de version. Dans ce cas, les en-têtes <span class=
            "quote">«&nbsp;<span class="quote">corrigés</span>&nbsp;»</span>
            doivent être mis à jour en lançant (en tant que <code class=
            "systemitem">root</code>)&nbsp;: <span class=
            "command"><strong>/usr/libexec/gcc/x86_64-pc-linux-gnu/8.2.0/install-tools/mkheaders</strong></span>
            . Le triplet de la machine peut être différent sur un système 32
            bits.
          </p>
        </div>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://ftp.gnu.org/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.xz">https://ftp.gnu.org/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Téléchargement (FTP)&nbsp;: <a class="ulink" href=
                "ftp://ftp.gnu.org/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.xz">ftp://ftp.gnu.org/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrôle MD5 du téléchargement&nbsp;:
                4ab282f414676496483b3e1793d07862
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 61 Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 8.5 Go (140 Mo
                supplémentaires pour les tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 29 SBU (avec
                parallélisme = 4, 106 SBU supplémentaires pour les tests avec
                parallélisme = 1)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de GCC
        </h3>
        <h4>
          Recommandées
        </h4>
        <p class="recommended">
          <a class="xref" href="dejagnu.html" title=
          "DejaGnu-1.6.2">DejaGnu-1.6.2</a> pour les tests
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "http://wiki.linuxfromscratch.org/blfs/wiki/gcc">http://wiki.linuxfromscratch.org/blfs/wiki/gcc</a>
        </p>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de GCC
        </h2>
        <div class="admon important">
          <img alt="[Important]" src="../images/important.png" />
          <h3>
            Important
          </h3>
          <p>
            Même si vous ne spécifiez que des langages autres que C et C++ à
            la commande <span class=
            "command"><strong>./configure</strong></span> ci-dessous, le
            processus d'installation écrasera les compilateurs C et C++ et
            les bibliothèques existantes de <span class=
            "application">GCC</span>. Avoir les paquets <span class=
            "application">Tcl</span>, <span class="application">Expect</span>
            et <span class="application">DejaGnu</span> d'installés avant de
            commencer la construction est hautement recommandé afin que vous
            puissiez lancer la suite de tests complète.
          </p>
          <p>
            Ne continuez pas avec la commande <span class=
            "command"><strong>make install</strong></span> avant d'être sûr
            que la construction a réussi. Vous pouvez comparer vos résultats
            de tests avec ceux qui se trouvent sur <a class="ulink" href=
            "http://gcc.gnu.org/ml/gcc-testresults/">http://gcc.gnu.org/ml/gcc-testresults/</a>.
            Il se peut que vous vouliez également vous référer aux
            informations qui se trouvent dans la section <span class=
            "application">GCC</span> du chapitre 6 du livre LFS (<a class=
            "ulink" href=
            "../../../../lfs/view/8.4/chapter06/gcc.html">../../../../lfs/view/8.4/chapter06/gcc.html</a>).
          </p>
        </div>
        <p>
          Les instructions ci-dessous utilisent intentionnellement le
          processus <span class="quote">«&nbsp;<span class=
          "quote">bootstrap</span>&nbsp;»</span>. Le bootstrap est utile pour
          la robustesse et est fortement recommandé pour un changement de
          version des compilateurs. Pour le désactiver, passez <em class=
          "parameter"><code>--disable-bootstrap</code></em> dans les options
          <span class="command"><strong>./configure</strong></span>
          ci-dessous.
        </p>
        <p>
          Installez <span class="application">GCC</span> en lançant les
          commandes suivantes&nbsp;:
        </p>
        <pre class="userinput"><kbd class="command">case $(uname -m) in
  x86_64)
    sed -e '/m64=/s/lib64/lib/' \
        -i.orig gcc/config/i386/t-linux64
  ;;
esac

mkdir build                                          &amp;&amp;
cd    build                                          &amp;&amp;

../configure                                         \
    --prefix=/usr                                    \
    --disable-multilib                               \
    --disable-libmpx                                 \
    --with-system-zlib                               \
    --enable-languages=c,c++,fortran,go,objc,obj-c++ &amp;&amp;
make</kbd></pre>
        <p>
          Si vous avez installé des paquets supplémentaires comme
          <span class="application">Valgrind</span> et <span class=
          "application">GDB</span>, la partie de <span class=
          "application">GCC</span> de la suite de tests lancera plus de tests
          que dans LFS. Certains d'entre eux signaleront des FAIL et d'autres
          XPASS (passage alors qu'un échec était attendu). Pour lancer les
          vérifications&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">ulimit -s 32768 &amp;&amp;
make -k check</kbd></pre>
        <p>
          Les tests sont très longs, et les résultats peuvent être très
          difficiles à trouver dans les logs, en particulier si vous utilisez
          des travaux en parallèle avec make. Vous pouvez avoir un résumé des
          tests avec&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">../contrib/test_summary</kbd></pre>
        <p>
          Maintenant, en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;

mkdir -pv /usr/share/gdb/auto-load/usr/lib              &amp;&amp;
mv -v /usr/lib/*gdb.py /usr/share/gdb/auto-load/usr/lib &amp;&amp;

chown -v -R root:root \
    /usr/lib/gcc/*linux-gnu/8.2.0/include{,-fixed}</kbd></pre>
        <p>
          Quelques paquets veulent trouver le préprocesseur C dans
          <code class="filename">/lib</code> ou peuvent se référer au
          compilateur C sous le nom de <span class=
          "command"><strong>cc</strong></span>. Les liens symboliques
          suivants ne sont pas utiles si vous avez suivi les instructions
          LFS, puisqu'ils sont déjà créés. Si vous ne les avez pas sur votre
          système, tapez en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class=
        "command">ln -v -sf ../usr/bin/cpp /lib          &amp;&amp;
ln -v -sf gcc /usr/bin/cc              &amp;&amp;
install -v -dm755 /usr/lib/bfd-plugins &amp;&amp;
ln -sfv ../../libexec/gcc/$(gcc -dumpmachine)/8.2.0/liblto_plugin.so /usr/lib/bfd-plugins/</kbd></pre>
      </div>
      <div class="commands" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Explication des commandes
        </h2>
        <p>
          <span class="command"><strong>mkdir build; cd
          build</strong></span>&nbsp;: La documentation de <span class=
          "application">GCC</span> recommande de construire le paquet dans un
          répertoire de construction dédié.
        </p>
        <p>
          <em class="parameter"><code>--disable-multilib</code></em>&nbsp;:
          Ce paramètre assure que les fichiers sont créés pour l'architecture
          spécifique à votre ordinateur.
        </p>
        <p>
          <em class="parameter"><code>--with-system-zlib</code></em>&nbsp;:
          Utilise la version système de <span class="application">zlib</span>
          au lieu de la version fournie. <span class=
          "application">zlib</span> est utilisé pour compresser et
          décompresser les langages intermédiaires de <span class=
          "application">GCC</span> dans les fichiers objets LTO "(Link Time
          Optimization)".
        </p>
        <p>
          <em class=
          "parameter"><code>--enable-languages=c,c++,fortran,go,objc,obj-c++</code></em>&nbsp;:
          Cette commande identifie les langages à construire. Vous pouvez
          changer cette commande pour retirer les langages dont vous ne
          voulez pas. Deux autres langages peuvent être ajoutés, en plus de
          ADA (voir l'introduction au-dessus)&nbsp;: BRIG (ajoutez <em class=
          "parameter"><code>brig</code></em> à la liste des langages
          disponibles), un format binaire pour HSAIL (Langage Intermédiaire
          pour Architectures Système Hétérogènes) et JIT (ajoutez <em class=
          "parameter"><code>jit</code></em> à la liste des langages
          disponibles), une bibliothèque qui peut être liée à un interpréteur
          qui souhaite générer du code machine <span class=
          "quote">«&nbsp;<span class="quote">à la volée</span>&nbsp;»</span>
          à l'exécution. Ils n'ont pas été testés par les développeurs de
          BLFS.
        </p>
        <p>
          <code class=
          "option">--with-default-libstdcxx-abi=gcc4-compatible</code>&nbsp;:
          Utilisez ce paramètre si vous mettez à jour depuis une version de
          <span class="application">GCC</span> inférieure à 5.1.0, et que
          vous ne voulez pas recompiler toutes les bibliothèques écrites en
          C++.
        </p>
        <p>
          <span class="command"><strong>ulimit -s
          32768</strong></span>&nbsp;: Cette commande empêche plusieurs
          scripts de tomber à court d'espace dans la pile.
        </p>
        <p>
          <span class="command"><strong>make -k check</strong></span>&nbsp;:
          Cette commande lance une suite de tests sans s'arrêter si une
          erreur est rencontrée.
        </p>
        <p>
          <span class=
          "command"><strong>../contrib/test_summary</strong></span>&nbsp;:
          Cette commande produira un résumé des résultats de la suite de
          tests. Vous pouvez ajouter <span class="command"><strong>| grep -A7
          Summ</strong></span> à la commande pour produire une version du
          résumé encore plus condensée. Il se peut que vous souhaitiez aussi
          rediriger la sortie vers un fichier pour visualiser et comparer à
          l'avenir.
        </p>
        <p>
          <span class="command"><strong>mv -v /usr/lib/*gdb.py
          ...</strong></span>&nbsp;: Le processus d'installation met quelques
          fichiers utilisé par <span class="application">gdb</span> dans le
          répertoire <code class="filename">/usr/lib</code>. Cela génère des
          messages d'erreur curieux quand <span class=
          "command"><strong>ldconfig</strong></span> est utilisé. Cette
          commande déplace les fichiers à un autre endroit.
        </p>
        <p>
          <span class="command"><strong>chown -v -R root:root
          /usr/lib/gcc/*linux-gnu/...</strong></span>&nbsp;: Si le paquet est
          construit par un utilisateur différent de root, le propriétaire du
          répertoire <code class="filename">include</code> installé sera
          incorrect. Ces commandes modifient l'appartenance vers
          l'utilisateur et le groupe <code class="systemitem">root</code>.
        </p>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contenu
        </h2>
        <p>
          Plusieurs noms de programmes et de bibliothèques et des
          descriptions ne sont pas listés ici, mais peuvent être trouvé dans
          <a class="ulink" href=
          "../../../../lfs/view/8.4/chapter06/gcc.html#contents-gcc">../../../../lfs/view/8.4/chapter06/gcc.html#contents-gcc</a>
          puisqu'ils sont initialement installés dans LFS.
        </p>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programmes installés:</strong>
              <span class="segbody">gccgo, go, gofmt et gfortran, liés en dur
              à des noms spécifiques à l'architecture</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Bibliothèques installées:</strong>
              <span class="segbody">libgfortran.{so,a}, libgo.{so,a},
              libgobegin.a, libgolibbegin.a, libobjc.{so,a}, et de nombreuses
              autres bibliothèques et exécutables.</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Répertoires installés:</strong>
              <span class="segbody">/usr/lib/go</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="gccgo" name="gccgo"></a><span class=
                    "term"><span class=
                    "command"><strong>gccgo</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un compilateur basé sur GCC pour le langage
                    <span class="application">Go</span>.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="go" name="go"></a><span class="term"><span class=
                    "command"><strong>go</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un outil pour la gestion du code source <span class=
                    "application">Go</span>.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="gofmt" name="gofmt"></a><span class=
                    "term"><span class=
                    "command"><strong>gofmt</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un outil pour le formatage du code source
                    <span class="application">Go</span>.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="gfortran" name="gfortran"></a><span class=
                    "term"><span class=
                    "command"><strong>gfortran</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un compilateur basé sur GCC pour le langage
                    <span class="application">Fortran</span>.
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on 2019-02-15 21:01:29 +0000
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="expect.html" title=
          "Expect-5.45.4">Précédent</a>
          <p>
            Expect-5.45.4
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="gcc-ada.html" title=
          "GCC-Ada-8.2.0">Suivant</a>
          <p>
            GCC-Ada-8.2.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="prog.html" title=
          "Chapitre&nbsp;13.&nbsp;Programmation">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà&nbsp;de Linux® From Scratch - Version 8.4">Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
